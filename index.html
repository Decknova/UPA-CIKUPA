<!DOCTYPE html>
<html lang="id">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Ramadan Tracker</title>

<script src="https://cdn.tailwindcss.com"></script>
<script src="https://cdn.jsdelivr.net/npm/chart.js"></script>

<style>
@import url('https://fonts.googleapis.com/css2?family=Plus+Jakarta+Sans:wght@400;600;700;800&display=swap');
body { font-family: 'Plus Jakarta Sans', sans-serif; background:#020617; }
.task-card.active { background:#064e3b; border-color:#10b981; }
.folder-content { display:none }
.folder-content.open { display:block }
</style>
</head>

<body class="text-slate-100 pb-20">

<div class="max-w-md mx-auto px-4">

<!-- HEADER -->
<header class="flex justify-between items-center py-6">
  <h1 class="text-xl font-black text-emerald-400">RAMADAN TRACKER</h1>
  <button onclick="openChart()" class="bg-slate-900 p-2 rounded-xl">üìä</button>
</header>

<!-- PILIH TANGGAL -->
<input type="date" id="datePicker"
class="w-full mb-4 bg-slate-900 p-4 rounded-xl border border-slate-800">

<!-- PILIH USER -->
<select id="userSelect" onchange="loadDayData()"
class="w-full mb-6 bg-slate-900 p-4 rounded-xl font-bold">
  <option>Arif</option>
  <option>Heru</option>
  <option>Fajar</option>
  <option>Faisal</option>
  <option>Mulyadi</option>
  <option>Yudi</option>
  <option>Kang Deny</option>
</select>

<!-- TASK -->
<div class="space-y-3">
  <div onclick="toggleTask(this)" data-task="subuh"
  class="task-card bg-slate-900 p-4 rounded-xl border border-slate-800 flex justify-between">
    Jamaah Subuh <span class="box"></span>
  </div>

  <div onclick="toggleTask(this)" data-task="dzuhur"
  class="task-card bg-slate-900 p-4 rounded-xl border border-slate-800 flex justify-between">
    Jamaah Dzuhur <span class="box"></span>
  </div>

  <div onclick="toggleTask(this)" data-task="tilawah"
  class="task-card bg-slate-900 p-4 rounded-xl border border-slate-800 flex justify-between">
    Tilawah Qur'an <span class="box"></span>
  </div>

  <div onclick="toggleTask(this)" data-task="sedekah"
  class="task-card bg-slate-900 p-4 rounded-xl border border-slate-800 flex justify-between">
    Sedekah <span class="box"></span>
  </div>
</div>

<!-- SIMPAN -->
<button onclick="saveDay()"
class="w-full mt-8 bg-emerald-600 py-4 rounded-xl font-black">
SIMPAN
</button>

</div>

<!-- MODAL CHART -->
<div id="chartModal"
class="fixed inset-0 bg-black/90 hidden items-center justify-center p-4">
  <div class="bg-slate-900 p-4 rounded-xl w-full max-w-md">
    <button onclick="closeChart()" class="mb-2">‚ùå</button>
    <canvas id="chart"></canvas>
  </div>
</div>

<script>
const users = ["Arif","Heru","Fajar","Faisal","Mulyadi","Yudi","Kang Deny"];
let db = JSON.parse(localStorage.getItem("ramadan_db")) || {};
let selectedDate;

// INIT
window.onload = () => {
  const today = new Date().toISOString().split("T")[0];
  document.getElementById("datePicker").value = today;
  selectedDate = today;
  loadDayData();
};

// DATE CHANGE
datePicker.onchange = e => {
  selectedDate = e.target.value;
  loadDayData();
};

// TOGGLE TASK
function toggleTask(el){
  el.classList.toggle("active");
  el.querySelector(".box").innerText =
    el.classList.contains("active") ? "‚úî" : "";
}

// SAVE
function saveDay(){
  const user = userSelect.value;
  const tasks = [];
  document.querySelectorAll(".task-card.active")
    .forEach(t => tasks.push(t.dataset.task));

  if(!db[user]) db[user] = {};
  db[user][selectedDate] = tasks;
  localStorage.setItem("ramadan_db", JSON.stringify(db));
  alert("Tersimpan");
}

// LOAD
function loadDayData(){
  document.querySelectorAll(".task-card").forEach(t=>{
    t.classList.remove("active");
    t.querySelector(".box").innerText="";
  });

  const user = userSelect.value;
  const data = db[user]?.[selectedDate] || [];
  data.forEach(task=>{
    const el = document.querySelector(`[data-task="${task}"]`);
    if(el){
      el.classList.add("active");
      el.querySelector(".box").innerText="‚úî";
    }
  });
}

// CHART
function openChart(){
  chartModal.classList.remove("hidden");
  const ctx = chart.getContext("2d");

  const data = users.map(u =>
    db[u]?.[selectedDate]?.length || 0
  );

  if(window.c) c.destroy();
  c = new Chart(ctx,{
    type:"bar",
    data:{ labels:users, datasets:[{ data }] },
    options:{ indexAxis:"y" }
  });
}
function closeChart(){ chartModal.classList.add("hidden"); }
</script>

</body>
</html>
